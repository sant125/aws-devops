## VPA para o CloudNativePG — modo Off (somente recomendação)
##
## O CNPG gerencia os pods diretamente via seu operator, então deixar o VPA
## aplicar mudanças automaticamente conflitaria com o operator. O modo Off
## expõe as recomendações no status do objeto — você aplica manualmente em
## spec.resources no postgres-cluster.yaml quando fizer sentido.
##
## Para ver as recomendações:
##   kubectl describe vpa tattoo-db-vpa -n database
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: tattoo-db-vpa
  namespace: database
spec:
  targetRef:
    apiVersion: postgresql.cnpg.io/v1
    kind: Cluster
    name: tattoo-db
  updatePolicy:
    updateMode: "Off"
  resourcePolicy:
    containerPolicies:
      - containerName: postgres
        minAllowed:
          cpu: 100m
          memory: 256Mi
        maxAllowed:
          cpu: 4
          memory: 16Gi
        controlledResources: ["cpu", "memory"]
